[![Project Example - Pipeline(CI)](https://github.com/leonardomelgarejo/test-automation-example/actions/workflows/cucumber-playwright.yml/badge.svg)](https://github.com/leonardomelgarejo/test-automation-example/actions/workflows/cucumber-playwright.yml)

![Drakkar](https://raw.githubusercontent.com/leonardomelgarejo/test-automation-example/main/assets/drakkar.jpeg) 

# Example Project on Test Automation using Cucumber + Playwright + TypeScript + GitHub Actions + ClickUp

## Description

This project covers web test automation, built on Node.js core + Cucumber-JS/Playwright frameworks + TypeScript language.

# Explanation of the project

[Watch the explanatory video](https://raw.githubusercontent.com/leonardomelgarejo/test-automation-example/main/assets/ExplanationOfTheProject.mp4)

# Prerequisites

* Install [Node.js 22.10.0](https://nodejs.org/pt/blog/release/v22.10.0)
* Install [Cucumber-JS 11.1.1](https://github.com/cucumber/cucumber-js)
* Install [Playwright 1.49](https://playwright.dev/docs/intro)
* Clone the repository:  
  ```bash
  https://github.com/leonardomelgarejo/test-automation-example.git
  ```
* [Local Execution Adjustments](#local-execution-adjustments)

## How to Run the Tests

### Local Execution

Test execution is orchestrated by Cucumber-JS, meaning you use tags tied to specific test scenarios, which follow the pattern `@` + purpose (e.g., `@smoke-test`). For this project, run the following commands:

* Run all tests (no tag is required):  
  ```bash
  npm test
  ```

* Run a specific group of test scenarios (specify the desired tag):  
  ```bash
  npm test --TAGS="@smoke-test"
  ```

* Run a specific group of test scenarios and ignore another group (specify both tags):  
  ```bash
  npm test --TAGS="@smoke-test and not @skip"
  ```

* Run test scenarios tagged A or B (specify the tags):  
  ```bash
  npm test --TAGS="@smoke-test or @functional-test"
  ```

* Run test scenarios tagged A and B (specify the tags):  
  ```bash
  npm test --TAGS="@smoke-test and @functional-test"
  ```

### Remote Execution by Tags (GitHub Actions)

Thanks to the `workflow_dispatch` feature, you can run the GitHub Actions workflow remotely by tags‚Äîchoosing the environment and whether to generate the QA Report in ClickUp (yes or no) using input parameters. Follow these steps:

1. Go to the **Actions** tab of the repository on GitHub.  
2. Select the **Project Example ‚Äì Pipeline(CI)** workflow.  
3. Click the **Run workflow** button.  
4. Choose the desired environment (dev or test).  
5. In the `tags` input field, enter the tags you want to run, for example: `@smoke-test`. If left blank, all test scenarios will be executed.  
6. The `qa_report` field defaults to ‚Äúno.‚Äù If you want to generate the QA Report, select ‚Äúyes.‚Äù  
7. Click **Run workflow** to start execution.  
8. After this workflow completes, the ‚Äúpages build and deployment‚Äù workflow is triggered automatically, producing a test report available at: [Cucumber Report HTML](https://leonardomelgarejo.github.io/test-automation-example/).  
9. The QA Report document is generated on the specific ClickUp page.

This feature allows you to execute tests remotely without modifying the code locally‚Äîjust configure the tags through the GitHub Actions interface.

**Note 1**: For the GitHub Actions CI workflow to run, you must set/include the following secrets in [Settings ‚Üí Secrets ‚Üí Actions](https://github.com/leonardomelgarejo/test-automation-example/settings/secrets/actions):

**Fixed secrets**:  
- `BASEURL_DEV`  
- `BASEURL_TEST`  
- `PASSWORD_DEV`  
- `PASSWORD_TEST`  
- `USER_NAME_DEV`  
- `USER_NAME_TEST`

**ClickUp**:  
- `CLICKUP_API_TOKEN`  
- `CLICKUP_LIST_ID`  
- `CLICKUP_TEST_LIST_ID`

**QA Report**:  
- `WORKSPACE_ID`  
- `DOC_ID`  
- `PAGE_ID`

**Note 2**: For integration with ClickUp, you must create the workspace (`WORKSPACE_ID`), the project folder, the Dev List (`CLICKUP_LIST_ID`), the Test List (`CLICKUP_TEST_LIST_ID`), the Deliverables document (`DOC_ID`), and the QA Report page (`PAGE_ID`).

### üìä Test Report

Test reports are generated by **Cucumber-JS** in two ways:

#### üìç Local Execution

When you run the tests (as described above), two files are created in the `test-result` folder:

- **`cucumber-report.json`** ‚Äì Contains the base structure and metadata of the report.  
- **`cucumber-report.html`** ‚Äì A detailed HTML report showing:  
  - Passed and failed tests.  
  - Execution success rate.  
  - Date and duration of the last run.  
  - Operating system used.  
  - Versions of **Node.js** and **Cucumber-JS**.  
  - A detailed list of **features** and **scenarios** executed.

To view the HTML report, just open the `cucumber-report.html` file in your browser. üöÄ

#### üìç Remote Execution

The report generation for remote runs is under maintenance and will be integrated into the CI/CD pipeline. The goal is to make them available via GitHub Actions.

The generated report can be accessed at [Cucumber Report HTML](https://leonardomelgarejo.github.io/test-automation-example/).  
The JSON report can be accessed directly at [Cucumber Report JSON](https://leonardomelgarejo.github.io/test-automation-example/report.json).

### üõ† How to Generate the HTML Report from JSON

If you want to generate the HTML report locally, follow these steps using the **Cucumber HTML Formatter**:

1. **Install the tool (if you don‚Äôt have it yet)**:  
   ```bash
   npm install --save-dev @cucumber/html-formatter
   ```

2. **Download the report JSON**:  
   ```bash
   wget -O report.json https://leonardomelgarejo.github.io/test-automation-example/report.json
   ```

3. **Generate the HTML report**:  
   ```bash
   npx @cucumber/html-formatter report.json > cucumber-report.html
   ```

4. **Open the report in your browser**:

   - On macOS:  
     ```bash
     open cucumber-report.html
     ```

   - On Linux:  
     ```bash
     xdg-open cucumber-report.html
     ```

   - On Windows (CMD or PowerShell):  
     ```bash
     start cucumber-report.html
     ```

### üõ† QA Report

The QA Report is generated by the CI when you select ‚Äúyes‚Äù for the `qa_report` input in the `workflow_dispatch`.

<!-- https://app.clickup.com/9015683785/v/dc/8cp0up9-775/8cp0up9-255 -->

[Check the QA Report link](https://app.clickup.com/9015683785/v/dc/8cp0up9-775/8cp0up9-255)

## Project Structure

```plaintext
‚îú‚îÄ‚îÄ .github
‚îÇ   ‚îú‚îÄ‚îÄ scripts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clickup_fail.sh
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prepare_reports.sh
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ qa_report.sh
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ report_clickup.sh
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ run_cucumber.sh
‚îÇ   ‚îî‚îÄ‚îÄ workflows
‚îÇ       ‚îî‚îÄ‚îÄ cucumber-playwright.yml
‚îú‚îÄ‚îÄ assets
‚îÇ   ‚îî‚îÄ‚îÄ drakkar_log.jpeg
‚îú‚îÄ‚îÄ config
‚îÇ   ‚îú‚îÄ‚îÄ cucumber.js
‚îÇ   ‚îî‚îÄ‚îÄ globalConfig.js
‚îú‚îÄ‚îÄ helper
‚îÇ   ‚îú‚îÄ‚îÄ browsers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ browserManages.ts
‚îÇ   ‚îú‚îÄ‚îÄ env
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .env.dev
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ .env.test
‚îÇ   ‚îú‚îÄ‚îÄ report
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ init.ts
‚îÇ   ‚îú‚îÄ‚îÄ types
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ env.d.ts
‚îÇ   ‚îú‚îÄ‚îÄ util
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cadastroCobrancaHelper.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dataRequests.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ requestConfig.ts
‚îÇ   ‚îî‚îÄ‚îÄ wrapper
‚îÇ       ‚îú‚îÄ‚îÄ assert.ts
‚îÇ       ‚îî‚îÄ‚îÄ playwrightWrappers.ts
‚îú‚îÄ‚îÄ hooks
‚îÇ   ‚îú‚îÄ‚îÄ hooks.ts
‚îÇ   ‚îî‚îÄ‚îÄ pageFixture.ts
‚îú‚îÄ‚îÄ pages
‚îÇ   ‚îî‚îÄ‚îÄ loginPage.ts
‚îú‚îÄ‚îÄ test
‚îÇ   ‚îú‚îÄ‚îÄ features
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telaDeLogin.feature
‚îÇ   ‚îî‚îÄ‚îÄ steps
‚îÇ       ‚îî‚îÄ‚îÄ telaDeLogin.ts
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ package-lock.json
‚îî‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ tsconfig.json
```

## About the Project Structure

### .github/workflows/cucumber-playwright.yml

Configuration file for executing the GitHub Actions pipeline.

### .github/scripts/*.sh

Helper scripts for running the GitHub Actions pipeline.

### config/cucumber.js

Configuration file for Cucumber-JS.

### helper/env

Centralizes environment variables and the mechanism to access them during test execution.

### helper/report

Resources that support test report generation.

### helper/util

General utility resources for test execution.

### helper/wrapper

Resources to optimize Playwright functionality.

### hooks

Resources for centralized management of preconditions and postconditions during test execution.

### pages

Resources for centralized management and mapping of static and dynamic elements on the HTML pages used in the software lifecycle during test execution.

### test

Contains the feature files and their step definitions‚Äîthat is, the Gherkin-style files organized into scenarios, which are then implemented in TypeScript files that use Playwright dependencies to run the tests.

### package-lock.json

The `package-lock.json` file plays a crucial role in dependency management for Node.js projects. It is generated automatically by npm (Node Package Manager) whenever you install, update, or remove packages.

### package.json

The `package.json` file is the main configuration file for a Node.js project.

### tsconfig.json

The `tsconfig.json` file is used to configure the TypeScript compiler (`tsc`).

## Project Patterns Applied

* Page Objects

## Pipeline

Currently, the CI pipeline includes the following steps:  
- **test**: Run the automated tests.  
- **deploy-report**: Deploy the test report to GitHub Pages.

### üì¶ Main Dependencies

| Package                    | Version | Function                                 |
|----------------------------|---------|------------------------------------------|
| `@cucumber/cucumber`       | 11.1.1  | BDD framework for test automation        |
| `@playwright/test`         | 1.49.1  | Web and API test automation              |
| `dotenv`                   | 16.4.7  | Environment variable management          |
| `ts-node`                  | 10.9.2  | Allows running TypeScript without compiling to JavaScript |

## Local Execution Adjustments

Adjustments for the `.env.test` file:  
Make sure to create the `.env.test` file in the `helper/env` directory with the following environment variables:

```bash
mkdir -p helper/env
echo "USER_NAME=User example" > helper/env/.env.test
echo "PASSWORD=Password example" >> helper/env/.env.test
echo "BASEURL=http://example.com" >> helper/env/.env.test
echo "ENV=test" >> helper/env/.env.test
```